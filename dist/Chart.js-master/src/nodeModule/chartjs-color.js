'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

/* MIT license */
var convert = require('./color-convert.js');
var string = require('./chartjs-color-string.js');

var Color = function Color(obj) {
	if (obj instanceof Color) {
		return obj;
	}
	if (!(this instanceof Color)) {
		return new Color(obj);
	}

	this.values = {
		rgb: [0, 0, 0],
		hsl: [0, 0, 0],
		hsv: [0, 0, 0],
		hwb: [0, 0, 0],
		cmyk: [0, 0, 0, 0],
		alpha: 1
	};

	// parse Color() argument
	var vals;
	if (typeof obj === 'string') {
		vals = string.getRgba(obj);
		if (vals) {
			this.setValues('rgb', vals);
		} else if (vals = string.getHsla(obj)) {
			this.setValues('hsl', vals);
		} else if (vals = string.getHwb(obj)) {
			this.setValues('hwb', vals);
		} else {
			throw new Error('Unable to parse color from string "' + obj + '"');
		}
	} else if ((typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object') {
		vals = obj;
		if (vals.r !== undefined || vals.red !== undefined) {
			this.setValues('rgb', vals);
		} else if (vals.l !== undefined || vals.lightness !== undefined) {
			this.setValues('hsl', vals);
		} else if (vals.v !== undefined || vals.value !== undefined) {
			this.setValues('hsv', vals);
		} else if (vals.w !== undefined || vals.whiteness !== undefined) {
			this.setValues('hwb', vals);
		} else if (vals.c !== undefined || vals.cyan !== undefined) {
			this.setValues('cmyk', vals);
		} else {
			throw new Error('Unable to parse color from object ' + JSON.stringify(obj));
		}
	}
};

Color.prototype = {
	rgb: function rgb() {
		return this.setSpace('rgb', arguments);
	},
	hsl: function hsl() {
		return this.setSpace('hsl', arguments);
	},
	hsv: function hsv() {
		return this.setSpace('hsv', arguments);
	},
	hwb: function hwb() {
		return this.setSpace('hwb', arguments);
	},
	cmyk: function cmyk() {
		return this.setSpace('cmyk', arguments);
	},

	rgbArray: function rgbArray() {
		return this.values.rgb;
	},
	hslArray: function hslArray() {
		return this.values.hsl;
	},
	hsvArray: function hsvArray() {
		return this.values.hsv;
	},
	hwbArray: function hwbArray() {
		var values = this.values;
		if (values.alpha !== 1) {
			return values.hwb.concat([values.alpha]);
		}
		return values.hwb;
	},
	cmykArray: function cmykArray() {
		return this.values.cmyk;
	},
	rgbaArray: function rgbaArray() {
		var values = this.values;
		return values.rgb.concat([values.alpha]);
	},
	hslaArray: function hslaArray() {
		var values = this.values;
		return values.hsl.concat([values.alpha]);
	},
	alpha: function alpha(val) {
		if (val === undefined) {
			return this.values.alpha;
		}
		this.setValues('alpha', val);
		return this;
	},

	red: function red(val) {
		return this.setChannel('rgb', 0, val);
	},
	green: function green(val) {
		return this.setChannel('rgb', 1, val);
	},
	blue: function blue(val) {
		return this.setChannel('rgb', 2, val);
	},
	hue: function hue(val) {
		if (val) {
			val %= 360;
			val = val < 0 ? 360 + val : val;
		}
		return this.setChannel('hsl', 0, val);
	},
	saturation: function saturation(val) {
		return this.setChannel('hsl', 1, val);
	},
	lightness: function lightness(val) {
		return this.setChannel('hsl', 2, val);
	},
	saturationv: function saturationv(val) {
		return this.setChannel('hsv', 1, val);
	},
	whiteness: function whiteness(val) {
		return this.setChannel('hwb', 1, val);
	},
	blackness: function blackness(val) {
		return this.setChannel('hwb', 2, val);
	},
	value: function value(val) {
		return this.setChannel('hsv', 2, val);
	},
	cyan: function cyan(val) {
		return this.setChannel('cmyk', 0, val);
	},
	magenta: function magenta(val) {
		return this.setChannel('cmyk', 1, val);
	},
	yellow: function yellow(val) {
		return this.setChannel('cmyk', 2, val);
	},
	black: function black(val) {
		return this.setChannel('cmyk', 3, val);
	},

	hexString: function hexString() {
		return string.hexString(this.values.rgb);
	},
	rgbString: function rgbString() {
		return string.rgbString(this.values.rgb, this.values.alpha);
	},
	rgbaString: function rgbaString() {
		return string.rgbaString(this.values.rgb, this.values.alpha);
	},
	percentString: function percentString() {
		return string.percentString(this.values.rgb, this.values.alpha);
	},
	hslString: function hslString() {
		return string.hslString(this.values.hsl, this.values.alpha);
	},
	hslaString: function hslaString() {
		return string.hslaString(this.values.hsl, this.values.alpha);
	},
	hwbString: function hwbString() {
		return string.hwbString(this.values.hwb, this.values.alpha);
	},
	keyword: function keyword() {
		return string.keyword(this.values.rgb, this.values.alpha);
	},

	rgbNumber: function rgbNumber() {
		var rgb = this.values.rgb;
		return rgb[0] << 16 | rgb[1] << 8 | rgb[2];
	},

	luminosity: function luminosity() {
		// http://www.w3.org/TR/WCAG20/#relativeluminancedef
		var rgb = this.values.rgb;
		var lum = [];
		for (var i = 0; i < rgb.length; i++) {
			var chan = rgb[i] / 255;
			lum[i] = chan <= 0.03928 ? chan / 12.92 : Math.pow((chan + 0.055) / 1.055, 2.4);
		}
		return 0.2126 * lum[0] + 0.7152 * lum[1] + 0.0722 * lum[2];
	},

	contrast: function contrast(color2) {
		// http://www.w3.org/TR/WCAG20/#contrast-ratiodef
		var lum1 = this.luminosity();
		var lum2 = color2.luminosity();
		if (lum1 > lum2) {
			return (lum1 + 0.05) / (lum2 + 0.05);
		}
		return (lum2 + 0.05) / (lum1 + 0.05);
	},

	level: function level(color2) {
		var contrastRatio = this.contrast(color2);
		if (contrastRatio >= 7.1) {
			return 'AAA';
		}

		return contrastRatio >= 4.5 ? 'AA' : '';
	},

	dark: function dark() {
		// YIQ equation from http://24ways.org/2010/calculating-color-contrast
		var rgb = this.values.rgb;
		var yiq = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;
		return yiq < 128;
	},

	light: function light() {
		return !this.dark();
	},

	negate: function negate() {
		var rgb = [];
		for (var i = 0; i < 3; i++) {
			rgb[i] = 255 - this.values.rgb[i];
		}
		this.setValues('rgb', rgb);
		return this;
	},

	lighten: function lighten(ratio) {
		var hsl = this.values.hsl;
		hsl[2] += hsl[2] * ratio;
		this.setValues('hsl', hsl);
		return this;
	},

	darken: function darken(ratio) {
		var hsl = this.values.hsl;
		hsl[2] -= hsl[2] * ratio;
		this.setValues('hsl', hsl);
		return this;
	},

	saturate: function saturate(ratio) {
		var hsl = this.values.hsl;
		hsl[1] += hsl[1] * ratio;
		this.setValues('hsl', hsl);
		return this;
	},

	desaturate: function desaturate(ratio) {
		var hsl = this.values.hsl;
		hsl[1] -= hsl[1] * ratio;
		this.setValues('hsl', hsl);
		return this;
	},

	whiten: function whiten(ratio) {
		var hwb = this.values.hwb;
		hwb[1] += hwb[1] * ratio;
		this.setValues('hwb', hwb);
		return this;
	},

	blacken: function blacken(ratio) {
		var hwb = this.values.hwb;
		hwb[2] += hwb[2] * ratio;
		this.setValues('hwb', hwb);
		return this;
	},

	greyscale: function greyscale() {
		var rgb = this.values.rgb;
		// http://en.wikipedia.org/wiki/Grayscale#Converting_color_to_grayscale
		var val = rgb[0] * 0.3 + rgb[1] * 0.59 + rgb[2] * 0.11;
		this.setValues('rgb', [val, val, val]);
		return this;
	},

	clearer: function clearer(ratio) {
		var alpha = this.values.alpha;
		this.setValues('alpha', alpha - alpha * ratio);
		return this;
	},

	opaquer: function opaquer(ratio) {
		var alpha = this.values.alpha;
		this.setValues('alpha', alpha + alpha * ratio);
		return this;
	},

	rotate: function rotate(degrees) {
		var hsl = this.values.hsl;
		var hue = (hsl[0] + degrees) % 360;
		hsl[0] = hue < 0 ? 360 + hue : hue;
		this.setValues('hsl', hsl);
		return this;
	},

	/**
  * Ported from sass implementation in C
  * https://github.com/sass/libsass/blob/0e6b4a2850092356aa3ece07c6b249f0221caced/functions.cpp#L209
  */
	mix: function mix(mixinColor, weight) {
		var color1 = this;
		var color2 = mixinColor;
		var p = weight === undefined ? 0.5 : weight;

		var w = 2 * p - 1;
		var a = color1.alpha() - color2.alpha();

		var w1 = ((w * a === -1 ? w : (w + a) / (1 + w * a)) + 1) / 2.0;
		var w2 = 1 - w1;

		return this.rgb(w1 * color1.red() + w2 * color2.red(), w1 * color1.green() + w2 * color2.green(), w1 * color1.blue() + w2 * color2.blue()).alpha(color1.alpha() * p + color2.alpha() * (1 - p));
	},

	toJSON: function toJSON() {
		return this.rgb();
	},

	clone: function clone() {
		// NOTE(SB): using node-clone creates a dependency to Buffer when using browserify,
		// making the final build way to big to embed in Chart.js. So let's do it manually,
		// assuming that values to clone are 1 dimension arrays containing only numbers,
		// except 'alpha' which is a number.
		var result = new Color();
		var source = this.values;
		var target = result.values;
		var value, type;

		for (var prop in source) {
			if (source.hasOwnProperty(prop)) {
				value = source[prop];
				type = {}.toString.call(value);
				if (type === '[object Array]') {
					target[prop] = value.slice(0);
				} else if (type === '[object Number]') {
					target[prop] = value;
				} else {
					console.error('unexpected color value:', value);
				}
			}
		}

		return result;
	}
};

Color.prototype.spaces = {
	rgb: ['red', 'green', 'blue'],
	hsl: ['hue', 'saturation', 'lightness'],
	hsv: ['hue', 'saturation', 'value'],
	hwb: ['hue', 'whiteness', 'blackness'],
	cmyk: ['cyan', 'magenta', 'yellow', 'black']
};

Color.prototype.maxes = {
	rgb: [255, 255, 255],
	hsl: [360, 100, 100],
	hsv: [360, 100, 100],
	hwb: [360, 100, 100],
	cmyk: [100, 100, 100, 100]
};

Color.prototype.getValues = function (space) {
	var values = this.values;
	var vals = {};

	for (var i = 0; i < space.length; i++) {
		vals[space.charAt(i)] = values[space][i];
	}

	if (values.alpha !== 1) {
		vals.a = values.alpha;
	}

	// {r: 255, g: 255, b: 255, a: 0.4}
	return vals;
};

Color.prototype.setValues = function (space, vals) {
	var values = this.values;
	var spaces = this.spaces;
	var maxes = this.maxes;
	var alpha = 1;
	var i;

	if (space === 'alpha') {
		alpha = vals;
	} else if (vals.length) {
		// [10, 10, 10]
		values[space] = vals.slice(0, space.length);
		alpha = vals[space.length];
	} else if (vals[space.charAt(0)] !== undefined) {
		// {r: 10, g: 10, b: 10}
		for (i = 0; i < space.length; i++) {
			values[space][i] = vals[space.charAt(i)];
		}

		alpha = vals.a;
	} else if (vals[spaces[space][0]] !== undefined) {
		// {red: 10, green: 10, blue: 10}
		var chans = spaces[space];

		for (i = 0; i < space.length; i++) {
			values[space][i] = vals[chans[i]];
		}

		alpha = vals.alpha;
	}

	values.alpha = Math.max(0, Math.min(1, alpha === undefined ? values.alpha : alpha));

	if (space === 'alpha') {
		return false;
	}

	var capped;

	// cap values of the space prior converting all values
	for (i = 0; i < space.length; i++) {
		capped = Math.max(0, Math.min(maxes[space][i], values[space][i]));
		values[space][i] = Math.round(capped);
	}

	// convert to all the other color spaces
	for (var sname in spaces) {
		if (sname !== space) {
			values[sname] = convert[space][sname](values[space]);
		}
	}

	return true;
};

Color.prototype.setSpace = function (space, args) {
	var vals = args[0];

	if (vals === undefined) {
		// color.rgb()
		return this.getValues(space);
	}

	// color.rgb(10, 10, 10)
	if (typeof vals === 'number') {
		vals = Array.prototype.slice.call(args);
	}

	this.setValues(space, vals);
	return this;
};

Color.prototype.setChannel = function (space, index, val) {
	var svalues = this.values[space];
	if (val === undefined) {
		// color.red()
		return svalues[index];
	} else if (val === svalues[index]) {
		// color.red(color.red())
		return this;
	}

	// color.red(100)
	svalues[index] = val;
	this.setValues(space, svalues);

	return this;
};

if (typeof window !== 'undefined') {
	window.Color = Color;
}

module.exports = Color;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoYXJ0anMtY29sb3IuanMiXSwibmFtZXMiOlsiY29udmVydCIsInJlcXVpcmUiLCJzdHJpbmciLCJDb2xvciIsIm9iaiIsInZhbHVlcyIsInJnYiIsImhzbCIsImhzdiIsImh3YiIsImNteWsiLCJhbHBoYSIsInZhbHMiLCJnZXRSZ2JhIiwic2V0VmFsdWVzIiwiZ2V0SHNsYSIsImdldEh3YiIsIkVycm9yIiwiciIsInVuZGVmaW5lZCIsInJlZCIsImwiLCJsaWdodG5lc3MiLCJ2IiwidmFsdWUiLCJ3Iiwid2hpdGVuZXNzIiwiYyIsImN5YW4iLCJKU09OIiwic3RyaW5naWZ5IiwicHJvdG90eXBlIiwic2V0U3BhY2UiLCJhcmd1bWVudHMiLCJyZ2JBcnJheSIsImhzbEFycmF5IiwiaHN2QXJyYXkiLCJod2JBcnJheSIsImNvbmNhdCIsImNteWtBcnJheSIsInJnYmFBcnJheSIsImhzbGFBcnJheSIsInZhbCIsInNldENoYW5uZWwiLCJncmVlbiIsImJsdWUiLCJodWUiLCJzYXR1cmF0aW9uIiwic2F0dXJhdGlvbnYiLCJibGFja25lc3MiLCJtYWdlbnRhIiwieWVsbG93IiwiYmxhY2siLCJoZXhTdHJpbmciLCJyZ2JTdHJpbmciLCJyZ2JhU3RyaW5nIiwicGVyY2VudFN0cmluZyIsImhzbFN0cmluZyIsImhzbGFTdHJpbmciLCJod2JTdHJpbmciLCJrZXl3b3JkIiwicmdiTnVtYmVyIiwibHVtaW5vc2l0eSIsImx1bSIsImkiLCJsZW5ndGgiLCJjaGFuIiwiTWF0aCIsInBvdyIsImNvbnRyYXN0IiwiY29sb3IyIiwibHVtMSIsImx1bTIiLCJsZXZlbCIsImNvbnRyYXN0UmF0aW8iLCJkYXJrIiwieWlxIiwibGlnaHQiLCJuZWdhdGUiLCJsaWdodGVuIiwicmF0aW8iLCJkYXJrZW4iLCJzYXR1cmF0ZSIsImRlc2F0dXJhdGUiLCJ3aGl0ZW4iLCJibGFja2VuIiwiZ3JleXNjYWxlIiwiY2xlYXJlciIsIm9wYXF1ZXIiLCJyb3RhdGUiLCJkZWdyZWVzIiwibWl4IiwibWl4aW5Db2xvciIsIndlaWdodCIsImNvbG9yMSIsInAiLCJhIiwidzEiLCJ3MiIsInRvSlNPTiIsImNsb25lIiwicmVzdWx0Iiwic291cmNlIiwidGFyZ2V0IiwidHlwZSIsInByb3AiLCJoYXNPd25Qcm9wZXJ0eSIsInRvU3RyaW5nIiwiY2FsbCIsInNsaWNlIiwiY29uc29sZSIsImVycm9yIiwic3BhY2VzIiwibWF4ZXMiLCJnZXRWYWx1ZXMiLCJzcGFjZSIsImNoYXJBdCIsImNoYW5zIiwibWF4IiwibWluIiwiY2FwcGVkIiwicm91bmQiLCJzbmFtZSIsImFyZ3MiLCJBcnJheSIsImluZGV4Iiwic3ZhbHVlcyIsIndpbmRvdyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBLElBQUlBLFVBQVVDLFFBQVEsaUJBQVIsQ0FBZDtBQUNBLElBQUlDLFNBQVNELFFBQVEsd0JBQVIsQ0FBYjs7QUFFQSxJQUFJRSxRQUFRLFNBQVJBLEtBQVEsQ0FBVUMsR0FBVixFQUFlO0FBQzFCLEtBQUlBLGVBQWVELEtBQW5CLEVBQTBCO0FBQ3pCLFNBQU9DLEdBQVA7QUFDQTtBQUNELEtBQUksRUFBRSxnQkFBZ0JELEtBQWxCLENBQUosRUFBOEI7QUFDN0IsU0FBTyxJQUFJQSxLQUFKLENBQVVDLEdBQVYsQ0FBUDtBQUNBOztBQUVELE1BQUtDLE1BQUwsR0FBYztBQUNiQyxPQUFLLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLENBRFE7QUFFYkMsT0FBSyxDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBUCxDQUZRO0FBR2JDLE9BQUssQ0FBQyxDQUFELEVBQUksQ0FBSixFQUFPLENBQVAsQ0FIUTtBQUliQyxPQUFLLENBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLENBSlE7QUFLYkMsUUFBTSxDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBUCxFQUFVLENBQVYsQ0FMTztBQU1iQyxTQUFPO0FBTk0sRUFBZDs7QUFTQTtBQUNBLEtBQUlDLElBQUo7QUFD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QWpCLEVBQXVCO0FBQ2pELEtBQUkvRyxPQUFPK0csS0FBSyxDQUFMLENBQVg7O0FBRUEsS0FBSS9HLFNBQVNPLFNBQWIsRUFBd0I7QUFDdkI7QUFDQSxTQUFPLEtBQUsrRixTQUFMLENBQWVDLEtBQWYsQ0FBUDtBQUNBOztBQUVEO0FBQ0EsS0FBSSxPQUFPdkcsSUFBUCxLQUFnQixRQUFwQixFQUE4QjtBQUM3QkEsU0FBT2dILE1BQU03RixTQUFOLENBQWdCOEUsS0FBaEIsQ0FBc0JELElBQXRCLENBQTJCZSxJQUEzQixDQUFQO0FBQ0E7O0FBRUQsTUFBSzdHLFNBQUwsQ0FBZXFHLEtBQWYsRUFBc0J2RyxJQUF0QjtBQUNBLFFBQU8sSUFBUDtBQUNBLENBZkQ7O0FBaUJBVCxNQUFNNEIsU0FBTixDQUFnQlksVUFBaEIsR0FBNkIsVUFBVXdFLEtBQVYsRUFBaUJVLEtBQWpCLEVBQXdCbkYsR0FBeEIsRUFBNkI7QUFDekQsS0FBSW9GLFVBQVUsS0FBS3pILE1BQUwsQ0FBWThHLEtBQVosQ0FBZDtBQUNBLEtBQUl6RSxRQUFRdkIsU0FBWixFQUF1QjtBQUN0QjtBQUNBLFNBQU8yRyxRQUFRRCxLQUFSLENBQVA7QUFDQSxFQUhELE1BR08sSUFBSW5GLFFBQVFvRixRQUFRRCxLQUFSLENBQVosRUFBNEI7QUFDbEM7QUFDQSxTQUFPLElBQVA7QUFDQTs7QUFFRDtBQUNBQyxTQUFRRCxLQUFSLElBQWlCbkYsR0FBakI7QUFDQSxNQUFLNUIsU0FBTCxDQUFlcUcsS0FBZixFQUFzQlcsT0FBdEI7O0FBRUEsUUFBTyxJQUFQO0FBQ0EsQ0FmRDs7QUFpQkEsSUFBSSxPQUFPQyxNQUFQLEtBQWtCLFdBQXRCLEVBQW1DO0FBQ2xDQSxRQUFPNUgsS0FBUCxHQUFlQSxLQUFmO0FBQ0E7O0FBRUQ2SCxPQUFPQyxPQUFQLEdBQWlCOUgsS0FBakIiLCJmaWxlIjoiY2hhcnRqcy1jb2xvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIE1JVCBsaWNlbnNlICovXHJcbnZhciBjb252ZXJ0ID0gcmVxdWlyZSgnLi9jb2xvci1jb252ZXJ0Jyk7XHJcbnZhciBzdHJpbmcgPSByZXF1aXJlKCcuL2NoYXJ0anMtY29sb3Itc3RyaW5nJyk7XHJcblxyXG52YXIgQ29sb3IgPSBmdW5jdGlvbiAob2JqKSB7XHJcblx0aWYgKG9iaiBpbnN0YW5jZW9mIENvbG9yKSB7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRpZiAoISh0aGlzIGluc3RhbmNlb2YgQ29sb3IpKSB7XHJcblx0XHRyZXR1cm4gbmV3IENvbG9yKG9iaik7XHJcblx0fVxyXG5cclxuXHR0aGlzLnZhbHVlcyA9IHtcclxuXHRcdHJnYjogWzAsIDAsIDBdLFxyXG5cdFx0aHNsOiBbMCwgMCwgMF0sXHJcblx0XHRoc3Y6IFswLCAwLCAwXSxcclxuXHRcdGh3YjogWzAsIDAsIDBdLFxyXG5cdFx0Y215azogWzAsIDAsIDAsIDBdLFxyXG5cdFx0YWxwaGE6IDFcclxuXHR9O1xyXG5cclxuXHQvLyBwYXJzZSBDb2xvcigpIGFyZ3VtZW50XHJcblx0dmFyIHZhbHM7XHJcblx0aWYgKHR5cGVvZiBvYmogPT09ICdzdHJpbmcnKSB7XHJcblx0XHR2YWxzID0gc3RyaW5nLmdldFJnYmEob2JqKTtcclxuXHRcdGlmICh2YWxzKSB7XHJcblx0XHRcdHRoaXMuc2V0VmFsdWVzKCdyZ2InLCB2YWxzKTtcclxuXHRcdH0gZWxzZSBpZiAodmFscyA9IHN0cmluZy5nZXRIc2xhKG9iaikpIHtcclxuXHRcdFx0dGhpcy5zZXRWYWx1ZXMoJ2hzbCcsIHZhbHMpO1xyXG5cdFx0fSBlbHNlIGlmICh2YWxzID0gc3RyaW5nLmdldEh3YihvYmopKSB7XHJcblx0XHRcdHRoaXMuc2V0VmFsdWVzKCdod2InLCB2YWxzKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIHBhcnNlIGNvbG9yIGZyb20gc3RyaW5nIFwiJyArIG9iaiArICdcIicpO1xyXG5cdFx0fVxyXG5cdH0gZWxzZSBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcclxuXHRcdHZhbHMgPSBvYmo7XHJcblx0XHRpZiAodmFscy5yICE9PSB1bmRlZmluZWQgfHwgdmFscy5yZWQgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHR0aGlzLnNldFZhbHVlcygncmdiJywgdmFscyk7XHJcblx0XHR9IGVsc2UgaWYgKHZhbHMubCAhPT0gdW5kZWZpbmVkIHx8IHZhbHMubGlnaHRuZXNzICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dGhpcy5zZXRWYWx1ZXMoJ2hzbCcsIHZhbHMpO1xyXG5cdFx0fSBlbHNlIGlmICh2YWxzLnYgIT09IHVuZGVmaW5lZCB8fCB2YWxzLnZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dGhpcy5zZXRWYWx1ZXMoJ2hzdicsIHZhbHMpO1xyXG5cdFx0fSBlbHNlIGlmICh2YWxzLncgIT09IHVuZGVmaW5lZCB8fCB2YWxzLndoaXRlbmVzcyAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMuc2V0VmFsdWVzKCdod2InLCB2YWxzKTtcclxuXHRcdH0gZWxzZSBpZiAodmFscy5jICE9PSB1bmRlZmluZWQgfHwgdmFscy5jeWFuICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0dGhpcy5zZXRWYWx1ZXMoJ2NteWsnLCB2YWxzKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIHBhcnNlIGNvbG9yIGZyb20gb2JqZWN0ICcgKyBKU09OLnN0cmluZ2lmeShvYmopKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUgPSB7XHJcblx0cmdiOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRTcGFjZSgncmdiJywgYXJndW1lbnRzKTtcclxuXHR9LFxyXG5cdGhzbDogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2V0U3BhY2UoJ2hzbCcsIGFyZ3VtZW50cyk7XHJcblx0fSxcclxuXHRoc3Y6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLnNldFNwYWNlKCdoc3YnLCBhcmd1bWVudHMpO1xyXG5cdH0sXHJcblx0aHdiOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRTcGFjZSgnaHdiJywgYXJndW1lbnRzKTtcclxuXHR9LFxyXG5cdGNteWs6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLnNldFNwYWNlKCdjbXlrJywgYXJndW1lbnRzKTtcclxuXHR9LFxyXG5cclxuXHRyZ2JBcnJheTogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMudmFsdWVzLnJnYjtcclxuXHR9LFxyXG5cdGhzbEFycmF5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy52YWx1ZXMuaHNsO1xyXG5cdH0sXHJcblx0aHN2QXJyYXk6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLnZhbHVlcy5oc3Y7XHJcblx0fSxcclxuXHRod2JBcnJheTogZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzO1xyXG5cdFx0aWYgKHZhbHVlcy5hbHBoYSAhPT0gMSkge1xyXG5cdFx0XHRyZXR1cm4gdmFsdWVzLmh3Yi5jb25jYXQoW3ZhbHVlcy5hbHBoYV0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHZhbHVlcy5od2I7XHJcblx0fSxcclxuXHRjbXlrQXJyYXk6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiB0aGlzLnZhbHVlcy5jbXlrO1xyXG5cdH0sXHJcblx0cmdiYUFycmF5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXM7XHJcblx0XHRyZXR1cm4gdmFsdWVzLnJnYi5jb25jYXQoW3ZhbHVlcy5hbHBoYV0pO1xyXG5cdH0sXHJcblx0aHNsYUFycmF5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdmFsdWVzID0gdGhpcy52YWx1ZXM7XHJcblx0XHRyZXR1cm4gdmFsdWVzLmhzbC5jb25jYXQoW3ZhbHVlcy5hbHBoYV0pO1xyXG5cdH0sXHJcblx0YWxwaGE6IGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdGlmICh2YWwgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy52YWx1ZXMuYWxwaGE7XHJcblx0XHR9XHJcblx0XHR0aGlzLnNldFZhbHVlcygnYWxwaGEnLCB2YWwpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0cmVkOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdyZ2InLCAwLCB2YWwpO1xyXG5cdH0sXHJcblx0Z3JlZW46IGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdHJldHVybiB0aGlzLnNldENoYW5uZWwoJ3JnYicsIDEsIHZhbCk7XHJcblx0fSxcclxuXHRibHVlOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdyZ2InLCAyLCB2YWwpO1xyXG5cdH0sXHJcblx0aHVlOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRpZiAodmFsKSB7XHJcblx0XHRcdHZhbCAlPSAzNjA7XHJcblx0XHRcdHZhbCA9IHZhbCA8IDAgPyAzNjAgKyB2YWwgOiB2YWw7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdoc2wnLCAwLCB2YWwpO1xyXG5cdH0sXHJcblx0c2F0dXJhdGlvbjogZnVuY3Rpb24gKHZhbCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbCgnaHNsJywgMSwgdmFsKTtcclxuXHR9LFxyXG5cdGxpZ2h0bmVzczogZnVuY3Rpb24gKHZhbCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2V0Q2hhbm5lbCgnaHNsJywgMiwgdmFsKTtcclxuXHR9LFxyXG5cdHNhdHVyYXRpb252OiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdoc3YnLCAxLCB2YWwpO1xyXG5cdH0sXHJcblx0d2hpdGVuZXNzOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdod2InLCAxLCB2YWwpO1xyXG5cdH0sXHJcblx0YmxhY2tuZXNzOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdod2InLCAyLCB2YWwpO1xyXG5cdH0sXHJcblx0dmFsdWU6IGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdHJldHVybiB0aGlzLnNldENoYW5uZWwoJ2hzdicsIDIsIHZhbCk7XHJcblx0fSxcclxuXHRjeWFuOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdjbXlrJywgMCwgdmFsKTtcclxuXHR9LFxyXG5cdG1hZ2VudGE6IGZ1bmN0aW9uICh2YWwpIHtcclxuXHRcdHJldHVybiB0aGlzLnNldENoYW5uZWwoJ2NteWsnLCAxLCB2YWwpO1xyXG5cdH0sXHJcblx0eWVsbG93OiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdjbXlrJywgMiwgdmFsKTtcclxuXHR9LFxyXG5cdGJsYWNrOiBmdW5jdGlvbiAodmFsKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXRDaGFubmVsKCdjbXlrJywgMywgdmFsKTtcclxuXHR9LFxyXG5cclxuXHRoZXhTdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBzdHJpbmcuaGV4U3RyaW5nKHRoaXMudmFsdWVzLnJnYik7XHJcblx0fSxcclxuXHRyZ2JTdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBzdHJpbmcucmdiU3RyaW5nKHRoaXMudmFsdWVzLnJnYiwgdGhpcy52YWx1ZXMuYWxwaGEpO1xyXG5cdH0sXHJcblx0cmdiYVN0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHN0cmluZy5yZ2JhU3RyaW5nKHRoaXMudmFsdWVzLnJnYiwgdGhpcy52YWx1ZXMuYWxwaGEpO1xyXG5cdH0sXHJcblx0cGVyY2VudFN0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHN0cmluZy5wZXJjZW50U3RyaW5nKHRoaXMudmFsdWVzLnJnYiwgdGhpcy52YWx1ZXMuYWxwaGEpO1xyXG5cdH0sXHJcblx0aHNsU3RyaW5nOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gc3RyaW5nLmhzbFN0cmluZyh0aGlzLnZhbHVlcy5oc2wsIHRoaXMudmFsdWVzLmFscGhhKTtcclxuXHR9LFxyXG5cdGhzbGFTdHJpbmc6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBzdHJpbmcuaHNsYVN0cmluZyh0aGlzLnZhbHVlcy5oc2wsIHRoaXMudmFsdWVzLmFscGhhKTtcclxuXHR9LFxyXG5cdGh3YlN0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHN0cmluZy5od2JTdHJpbmcodGhpcy52YWx1ZXMuaHdiLCB0aGlzLnZhbHVlcy5hbHBoYSk7XHJcblx0fSxcclxuXHRrZXl3b3JkOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gc3RyaW5nLmtleXdvcmQodGhpcy52YWx1ZXMucmdiLCB0aGlzLnZhbHVlcy5hbHBoYSk7XHJcblx0fSxcclxuXHJcblx0cmdiTnVtYmVyOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcmdiID0gdGhpcy52YWx1ZXMucmdiO1xyXG5cdFx0cmV0dXJuIChyZ2JbMF0gPDwgMTYpIHwgKHJnYlsxXSA8PCA4KSB8IHJnYlsyXTtcclxuXHR9LFxyXG5cclxuXHRsdW1pbm9zaXR5OiBmdW5jdGlvbiAoKSB7XHJcblx0XHQvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9XQ0FHMjAvI3JlbGF0aXZlbHVtaW5hbmNlZGVmXHJcblx0XHR2YXIgcmdiID0gdGhpcy52YWx1ZXMucmdiO1xyXG5cdFx0dmFyIGx1bSA9IFtdO1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCByZ2IubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGNoYW4gPSByZ2JbaV0gLyAyNTU7XHJcblx0XHRcdGx1bVtpXSA9IChjaGFuIDw9IDAuMDM5MjgpID8gY2hhbiAvIDEyLjkyIDogTWF0aC5wb3coKChjaGFuICsgMC4wNTUpIC8gMS4wNTUpLCAyLjQpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDAuMjEyNiAqIGx1bVswXSArIDAuNzE1MiAqIGx1bVsxXSArIDAuMDcyMiAqIGx1bVsyXTtcclxuXHR9LFxyXG5cclxuXHRjb250cmFzdDogZnVuY3Rpb24gKGNvbG9yMikge1xyXG5cdFx0Ly8gaHR0cDovL3d3dy53My5vcmcvVFIvV0NBRzIwLyNjb250cmFzdC1yYXRpb2RlZlxyXG5cdFx0dmFyIGx1bTEgPSB0aGlzLmx1bWlub3NpdHkoKTtcclxuXHRcdHZhciBsdW0yID0gY29sb3IyLmx1bWlub3NpdHkoKTtcclxuXHRcdGlmIChsdW0xID4gbHVtMikge1xyXG5cdFx0XHRyZXR1cm4gKGx1bTEgKyAwLjA1KSAvIChsdW0yICsgMC4wNSk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gKGx1bTIgKyAwLjA1KSAvIChsdW0xICsgMC4wNSk7XHJcblx0fSxcclxuXHJcblx0bGV2ZWw6IGZ1bmN0aW9uIChjb2xvcjIpIHtcclxuXHRcdHZhciBjb250cmFzdFJhdGlvID0gdGhpcy5jb250cmFzdChjb2xvcjIpO1xyXG5cdFx0aWYgKGNvbnRyYXN0UmF0aW8gPj0gNy4xKSB7XHJcblx0XHRcdHJldHVybiAnQUFBJztcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gKGNvbnRyYXN0UmF0aW8gPj0gNC41KSA/ICdBQScgOiAnJztcclxuXHR9LFxyXG5cclxuXHRkYXJrOiBmdW5jdGlvbiAoKSB7XHJcblx0XHQvLyBZSVEgZXF1YXRpb24gZnJvbSBodHRwOi8vMjR3YXlzLm9yZy8yMDEwL2NhbGN1bGF0aW5nLWNvbG9yLWNvbnRyYXN0XHJcblx0XHR2YXIgcmdiID0gdGhpcy52YWx1ZXMucmdiO1xyXG5cdFx0dmFyIHlpcSA9IChyZ2JbMF0gKiAyOTkgKyByZ2JbMV0gKiA1ODcgKyByZ2JbMl0gKiAxMTQpIC8gMTAwMDtcclxuXHRcdHJldHVybiB5aXEgPCAxMjg7XHJcblx0fSxcclxuXHJcblx0bGlnaHQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiAhdGhpcy5kYXJrKCk7XHJcblx0fSxcclxuXHJcblx0bmVnYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcmdiID0gW107XHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xyXG5cdFx0XHRyZ2JbaV0gPSAyNTUgLSB0aGlzLnZhbHVlcy5yZ2JbaV07XHJcblx0XHR9XHJcblx0XHR0aGlzLnNldFZhbHVlcygncmdiJywgcmdiKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGxpZ2h0ZW46IGZ1bmN0aW9uIChyYXRpbykge1xyXG5cdFx0dmFyIGhzbCA9IHRoaXMudmFsdWVzLmhzbDtcclxuXHRcdGhzbFsyXSArPSBoc2xbMl0gKiByYXRpbztcclxuXHRcdHRoaXMuc2V0VmFsdWVzKCdoc2wnLCBoc2wpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0ZGFya2VuOiBmdW5jdGlvbiAocmF0aW8pIHtcclxuXHRcdHZhciBoc2wgPSB0aGlzLnZhbHVlcy5oc2w7XHJcblx0XHRoc2xbMl0gLT0gaHNsWzJdICogcmF0aW87XHJcblx0XHR0aGlzLnNldFZhbHVlcygnaHNsJywgaHNsKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdHNhdHVyYXRlOiBmdW5jdGlvbiAocmF0aW8pIHtcclxuXHRcdHZhciBoc2wgPSB0aGlzLnZhbHVlcy5oc2w7XHJcblx0XHRoc2xbMV0gKz0gaHNsWzFdICogcmF0aW87XHJcblx0XHR0aGlzLnNldFZhbHVlcygnaHNsJywgaHNsKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGRlc2F0dXJhdGU6IGZ1bmN0aW9uIChyYXRpbykge1xyXG5cdFx0dmFyIGhzbCA9IHRoaXMudmFsdWVzLmhzbDtcclxuXHRcdGhzbFsxXSAtPSBoc2xbMV0gKiByYXRpbztcclxuXHRcdHRoaXMuc2V0VmFsdWVzKCdoc2wnLCBoc2wpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0d2hpdGVuOiBmdW5jdGlvbiAocmF0aW8pIHtcclxuXHRcdHZhciBod2IgPSB0aGlzLnZhbHVlcy5od2I7XHJcblx0XHRod2JbMV0gKz0gaHdiWzFdICogcmF0aW87XHJcblx0XHR0aGlzLnNldFZhbHVlcygnaHdiJywgaHdiKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdGJsYWNrZW46IGZ1bmN0aW9uIChyYXRpbykge1xyXG5cdFx0dmFyIGh3YiA9IHRoaXMudmFsdWVzLmh3YjtcclxuXHRcdGh3YlsyXSArPSBod2JbMl0gKiByYXRpbztcclxuXHRcdHRoaXMuc2V0VmFsdWVzKCdod2InLCBod2IpO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0Z3JleXNjYWxlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgcmdiID0gdGhpcy52YWx1ZXMucmdiO1xyXG5cdFx0Ly8gaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9HcmF5c2NhbGUjQ29udmVydGluZ19jb2xvcl90b19ncmF5c2NhbGVcclxuXHRcdHZhciB2YWwgPSByZ2JbMF0gKiAwLjMgKyByZ2JbMV0gKiAwLjU5ICsgcmdiWzJdICogMC4xMTtcclxuXHRcdHRoaXMuc2V0VmFsdWVzKCdyZ2InLCBbdmFsLCB2YWwsIHZhbF0pO1xyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSxcclxuXHJcblx0Y2xlYXJlcjogZnVuY3Rpb24gKHJhdGlvKSB7XHJcblx0XHR2YXIgYWxwaGEgPSB0aGlzLnZhbHVlcy5hbHBoYTtcclxuXHRcdHRoaXMuc2V0VmFsdWVzKCdhbHBoYScsIGFscGhhIC0gKGFscGhhICogcmF0aW8pKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdG9wYXF1ZXI6IGZ1bmN0aW9uIChyYXRpbykge1xyXG5cdFx0dmFyIGFscGhhID0gdGhpcy52YWx1ZXMuYWxwaGE7XHJcblx0XHR0aGlzLnNldFZhbHVlcygnYWxwaGEnLCBhbHBoYSArIChhbHBoYSAqIHJhdGlvKSk7XHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9LFxyXG5cclxuXHRyb3RhdGU6IGZ1bmN0aW9uIChkZWdyZWVzKSB7XHJcblx0XHR2YXIgaHNsID0gdGhpcy52YWx1ZXMuaHNsO1xyXG5cdFx0dmFyIGh1ZSA9IChoc2xbMF0gKyBkZWdyZWVzKSAlIDM2MDtcclxuXHRcdGhzbFswXSA9IGh1ZSA8IDAgPyAzNjAgKyBodWUgOiBodWU7XHJcblx0XHR0aGlzLnNldFZhbHVlcygnaHNsJywgaHNsKTtcclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH0sXHJcblxyXG5cdC8qKlxyXG5cdCAqIFBvcnRlZCBmcm9tIHNhc3MgaW1wbGVtZW50YXRpb24gaW4gQ1xyXG5cdCAqIGh0dHBzOi8vZ2l0aHViLmNvbS9zYXNzL2xpYnNhc3MvYmxvYi8wZTZiNGEyODUwMDkyMzU2YWEzZWNlMDdjNmIyNDlmMDIyMWNhY2VkL2Z1bmN0aW9ucy5jcHAjTDIwOVxyXG5cdCAqL1xyXG5cdG1peDogZnVuY3Rpb24gKG1peGluQ29sb3IsIHdlaWdodCkge1xyXG5cdFx0dmFyIGNvbG9yMSA9IHRoaXM7XHJcblx0XHR2YXIgY29sb3IyID0gbWl4aW5Db2xvcjtcclxuXHRcdHZhciBwID0gd2VpZ2h0ID09PSB1bmRlZmluZWQgPyAwLjUgOiB3ZWlnaHQ7XHJcblxyXG5cdFx0dmFyIHcgPSAyICogcCAtIDE7XHJcblx0XHR2YXIgYSA9IGNvbG9yMS5hbHBoYSgpIC0gY29sb3IyLmFscGhhKCk7XHJcblxyXG5cdFx0dmFyIHcxID0gKCgodyAqIGEgPT09IC0xKSA/IHcgOiAodyArIGEpIC8gKDEgKyB3ICogYSkpICsgMSkgLyAyLjA7XHJcblx0XHR2YXIgdzIgPSAxIC0gdzE7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXNcclxuXHRcdFx0LnJnYihcclxuXHRcdFx0XHR3MSAqIGNvbG9yMS5yZWQoKSArIHcyICogY29sb3IyLnJlZCgpLFxyXG5cdFx0XHRcdHcxICogY29sb3IxLmdyZWVuKCkgKyB3MiAqIGNvbG9yMi5ncmVlbigpLFxyXG5cdFx0XHRcdHcxICogY29sb3IxLmJsdWUoKSArIHcyICogY29sb3IyLmJsdWUoKVxyXG5cdFx0XHQpXHJcblx0XHRcdC5hbHBoYShjb2xvcjEuYWxwaGEoKSAqIHAgKyBjb2xvcjIuYWxwaGEoKSAqICgxIC0gcCkpO1xyXG5cdH0sXHJcblxyXG5cdHRvSlNPTjogZnVuY3Rpb24gKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMucmdiKCk7XHJcblx0fSxcclxuXHJcblx0Y2xvbmU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdC8vIE5PVEUoU0IpOiB1c2luZyBub2RlLWNsb25lIGNyZWF0ZXMgYSBkZXBlbmRlbmN5IHRvIEJ1ZmZlciB3aGVuIHVzaW5nIGJyb3dzZXJpZnksXHJcblx0XHQvLyBtYWtpbmcgdGhlIGZpbmFsIGJ1aWxkIHdheSB0byBiaWcgdG8gZW1iZWQgaW4gQ2hhcnQuanMuIFNvIGxldCdzIGRvIGl0IG1hbnVhbGx5LFxyXG5cdFx0Ly8gYXNzdW1pbmcgdGhhdCB2YWx1ZXMgdG8gY2xvbmUgYXJlIDEgZGltZW5zaW9uIGFycmF5cyBjb250YWluaW5nIG9ubHkgbnVtYmVycyxcclxuXHRcdC8vIGV4Y2VwdCAnYWxwaGEnIHdoaWNoIGlzIGEgbnVtYmVyLlxyXG5cdFx0dmFyIHJlc3VsdCA9IG5ldyBDb2xvcigpO1xyXG5cdFx0dmFyIHNvdXJjZSA9IHRoaXMudmFsdWVzO1xyXG5cdFx0dmFyIHRhcmdldCA9IHJlc3VsdC52YWx1ZXM7XHJcblx0XHR2YXIgdmFsdWUsIHR5cGU7XHJcblxyXG5cdFx0Zm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcclxuXHRcdFx0aWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xyXG5cdFx0XHRcdHZhbHVlID0gc291cmNlW3Byb3BdO1xyXG5cdFx0XHRcdHR5cGUgPSAoe30pLnRvU3RyaW5nLmNhbGwodmFsdWUpO1xyXG5cdFx0XHRcdGlmICh0eXBlID09PSAnW29iamVjdCBBcnJheV0nKSB7XHJcblx0XHRcdFx0XHR0YXJnZXRbcHJvcF0gPSB2YWx1ZS5zbGljZSgwKTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKHR5cGUgPT09ICdbb2JqZWN0IE51bWJlcl0nKSB7XHJcblx0XHRcdFx0XHR0YXJnZXRbcHJvcF0gPSB2YWx1ZTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcigndW5leHBlY3RlZCBjb2xvciB2YWx1ZTonLCB2YWx1ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUuc3BhY2VzID0ge1xyXG5cdHJnYjogWydyZWQnLCAnZ3JlZW4nLCAnYmx1ZSddLFxyXG5cdGhzbDogWydodWUnLCAnc2F0dXJhdGlvbicsICdsaWdodG5lc3MnXSxcclxuXHRoc3Y6IFsnaHVlJywgJ3NhdHVyYXRpb24nLCAndmFsdWUnXSxcclxuXHRod2I6IFsnaHVlJywgJ3doaXRlbmVzcycsICdibGFja25lc3MnXSxcclxuXHRjbXlrOiBbJ2N5YW4nLCAnbWFnZW50YScsICd5ZWxsb3cnLCAnYmxhY2snXVxyXG59O1xyXG5cclxuQ29sb3IucHJvdG90eXBlLm1heGVzID0ge1xyXG5cdHJnYjogWzI1NSwgMjU1LCAyNTVdLFxyXG5cdGhzbDogWzM2MCwgMTAwLCAxMDBdLFxyXG5cdGhzdjogWzM2MCwgMTAwLCAxMDBdLFxyXG5cdGh3YjogWzM2MCwgMTAwLCAxMDBdLFxyXG5cdGNteWs6IFsxMDAsIDEwMCwgMTAwLCAxMDBdXHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUuZ2V0VmFsdWVzID0gZnVuY3Rpb24gKHNwYWNlKSB7XHJcblx0dmFyIHZhbHVlcyA9IHRoaXMudmFsdWVzO1xyXG5cdHZhciB2YWxzID0ge307XHJcblxyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgc3BhY2UubGVuZ3RoOyBpKyspIHtcclxuXHRcdHZhbHNbc3BhY2UuY2hhckF0KGkpXSA9IHZhbHVlc1tzcGFjZV1baV07XHJcblx0fVxyXG5cclxuXHRpZiAodmFsdWVzLmFscGhhICE9PSAxKSB7XHJcblx0XHR2YWxzLmEgPSB2YWx1ZXMuYWxwaGE7XHJcblx0fVxyXG5cclxuXHQvLyB7cjogMjU1LCBnOiAyNTUsIGI6IDI1NSwgYTogMC40fVxyXG5cdHJldHVybiB2YWxzO1xyXG59O1xyXG5cclxuQ29sb3IucHJvdG90eXBlLnNldFZhbHVlcyA9IGZ1bmN0aW9uIChzcGFjZSwgdmFscykge1xyXG5cdHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlcztcclxuXHR2YXIgc3BhY2VzID0gdGhpcy5zcGFjZXM7XHJcblx0dmFyIG1heGVzID0gdGhpcy5tYXhlcztcclxuXHR2YXIgYWxwaGEgPSAxO1xyXG5cdHZhciBpO1xyXG5cclxuXHRpZiAoc3BhY2UgPT09ICdhbHBoYScpIHtcclxuXHRcdGFscGhhID0gdmFscztcclxuXHR9IGVsc2UgaWYgKHZhbHMubGVuZ3RoKSB7XHJcblx0XHQvLyBbMTAsIDEwLCAxMF1cclxuXHRcdHZhbHVlc1tzcGFjZV0gPSB2YWxzLnNsaWNlKDAsIHNwYWNlLmxlbmd0aCk7XHJcblx0XHRhbHBoYSA9IHZhbHNbc3BhY2UubGVuZ3RoXTtcclxuXHR9IGVsc2UgaWYgKHZhbHNbc3BhY2UuY2hhckF0KDApXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHQvLyB7cjogMTAsIGc6IDEwLCBiOiAxMH1cclxuXHRcdGZvciAoaSA9IDA7IGkgPCBzcGFjZS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YWx1ZXNbc3BhY2VdW2ldID0gdmFsc1tzcGFjZS5jaGFyQXQoaSldO1xyXG5cdFx0fVxyXG5cclxuXHRcdGFscGhhID0gdmFscy5hO1xyXG5cdH0gZWxzZSBpZiAodmFsc1tzcGFjZXNbc3BhY2VdWzBdXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHQvLyB7cmVkOiAxMCwgZ3JlZW46IDEwLCBibHVlOiAxMH1cclxuXHRcdHZhciBjaGFucyA9IHNwYWNlc1tzcGFjZV07XHJcblxyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHNwYWNlLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhbHVlc1tzcGFjZV1baV0gPSB2YWxzW2NoYW5zW2ldXTtcclxuXHRcdH1cclxuXHJcblx0XHRhbHBoYSA9IHZhbHMuYWxwaGE7XHJcblx0fVxyXG5cclxuXHR2YWx1ZXMuYWxwaGEgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCAoYWxwaGEgPT09IHVuZGVmaW5lZCA/IHZhbHVlcy5hbHBoYSA6IGFscGhhKSkpO1xyXG5cclxuXHRpZiAoc3BhY2UgPT09ICdhbHBoYScpIHtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblxyXG5cdHZhciBjYXBwZWQ7XHJcblxyXG5cdC8vIGNhcCB2YWx1ZXMgb2YgdGhlIHNwYWNlIHByaW9yIGNvbnZlcnRpbmcgYWxsIHZhbHVlc1xyXG5cdGZvciAoaSA9IDA7IGkgPCBzcGFjZS5sZW5ndGg7IGkrKykge1xyXG5cdFx0Y2FwcGVkID0gTWF0aC5tYXgoMCwgTWF0aC5taW4obWF4ZXNbc3BhY2VdW2ldLCB2YWx1ZXNbc3BhY2VdW2ldKSk7XHJcblx0XHR2YWx1ZXNbc3BhY2VdW2ldID0gTWF0aC5yb3VuZChjYXBwZWQpO1xyXG5cdH1cclxuXHJcblx0Ly8gY29udmVydCB0byBhbGwgdGhlIG90aGVyIGNvbG9yIHNwYWNlc1xyXG5cdGZvciAodmFyIHNuYW1lIGluIHNwYWNlcykge1xyXG5cdFx0aWYgKHNuYW1lICE9PSBzcGFjZSkge1xyXG5cdFx0XHR2YWx1ZXNbc25hbWVdID0gY29udmVydFtzcGFjZV1bc25hbWVdKHZhbHVlc1tzcGFjZV0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHRydWU7XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUuc2V0U3BhY2UgPSBmdW5jdGlvbiAoc3BhY2UsIGFyZ3MpIHtcclxuXHR2YXIgdmFscyA9IGFyZ3NbMF07XHJcblxyXG5cdGlmICh2YWxzID09PSB1bmRlZmluZWQpIHtcclxuXHRcdC8vIGNvbG9yLnJnYigpXHJcblx0XHRyZXR1cm4gdGhpcy5nZXRWYWx1ZXMoc3BhY2UpO1xyXG5cdH1cclxuXHJcblx0Ly8gY29sb3IucmdiKDEwLCAxMCwgMTApXHJcblx0aWYgKHR5cGVvZiB2YWxzID09PSAnbnVtYmVyJykge1xyXG5cdFx0dmFscyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3MpO1xyXG5cdH1cclxuXHJcblx0dGhpcy5zZXRWYWx1ZXMoc3BhY2UsIHZhbHMpO1xyXG5cdHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuQ29sb3IucHJvdG90eXBlLnNldENoYW5uZWwgPSBmdW5jdGlvbiAoc3BhY2UsIGluZGV4LCB2YWwpIHtcclxuXHR2YXIgc3ZhbHVlcyA9IHRoaXMudmFsdWVzW3NwYWNlXTtcclxuXHRpZiAodmFsID09PSB1bmRlZmluZWQpIHtcclxuXHRcdC8vIGNvbG9yLnJlZCgpXHJcblx0XHRyZXR1cm4gc3ZhbHVlc1tpbmRleF07XHJcblx0fSBlbHNlIGlmICh2YWwgPT09IHN2YWx1ZXNbaW5kZXhdKSB7XHJcblx0XHQvLyBjb2xvci5yZWQoY29sb3IucmVkKCkpXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XHJcblxyXG5cdC8vIGNvbG9yLnJlZCgxMDApXHJcblx0c3ZhbHVlc1tpbmRleF0gPSB2YWw7XHJcblx0dGhpcy5zZXRWYWx1ZXMoc3BhY2UsIHN2YWx1ZXMpO1xyXG5cclxuXHRyZXR1cm4gdGhpcztcclxufTtcclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG5cdHdpbmRvdy5Db2xvciA9IENvbG9yO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IENvbG9yO1xyXG4iXX0=